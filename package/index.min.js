!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define("@firestitch/phone",[],t):"object"==typeof exports?exports["@firestitch/phone"]=t():e["@firestitch/phone"]=t()}("undefined"!=typeof self?self:this,function(){return function(e){function t(n){if(r[n])return r[n].exports;var o=r[n]={i:n,l:!1,exports:{}};return e[n].call(o.exports,o,o.exports,t),o.l=!0,o.exports}var r={};return t.m=e,t.c=r,t.d=function(e,r,n){t.o(e,r)||Object.defineProperty(e,r,{configurable:!1,enumerable:!0,get:n})},t.n=function(e){var r=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(r,"a",r),r},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="",t(t.s="./index.ts")}({"./fsphone-masks.ts":function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PHONE_MASKS={ru:["+","7","(",/\d/,/\d/,/\d/,")",/\d/,/\d/,/\d/,"-",/\d/,/\d/,"-",/\d/,/\d/],us:["(",/\d/,/\d/,/\d/,")"," ",/\d/,/\d/,/\d/,"-",/\d/,/\d/,/\d/,/\d/]}},"./fsphone.directive.ts":function(e,t,r){"use strict";var n=this&&this.__decorate||function(e,t,r,n){var o,i=arguments.length,s=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,r,n);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(s=(i<3?o(s):i>3?o(t,r,s):o(t,r))||s);return i>3&&s&&Object.defineProperty(t,r,s),s},o=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},i=this&&this.__param||function(e,t){return function(r,n){t(r,n,e)}};Object.defineProperty(t,"__esModule",{value:!0});var s=r("./services/fsphone.service.ts"),a=r("./fsphone.value-accessor.ts"),c=r("@angular/core"),u=function(){function e(e,t,r){var n=this;this._elementRef=e,this.renderer=t,this.service=r,this.fsPhoneConfig={maskType:"us",mask:null},this._onTouched=function(){},this._onChange=function(e){},this.onFocused=function(e){n.setInitialValue(e)},this.onKeyup=function(e){if("Delete"==e.key||"Backspace"==e.key)n.setInitialValue(e);else if("Home"==e.key){var t=n.service.getFirstAvailableCaretPos(n.mask);e.target.setSelectionRange(t,t)}n.goOnKeyup&&(e.target.setSelectionRange(n.goOnKeyup,n.goOnKeyup),delete n.goOnKeyup)},this.onClick=function(e){n.manageCaret(e)},this.onKeydown=function(e){switch(e.key){case"Shift":case"Meta":case"ArrowRight":break;case"ArrowLeft":if(e.shiftKey||e.metaKey)e.metaKey&&(n.goOnKeyup=n.service.getFirstAvailableCaretPos(n.mask));else{var t=e.target.selectionStart;n.service.getFirstAvailableCaretPos(n.mask)>=t&&(t=e.target.selectionStart+1),e.target.setSelectionRange(t,t)}break;case"Backspace":n.trackCaret(e,-2);break;case"Delete":n.caretMove=e.target.selectionStart-1;break;default:n.trackCaret(e)}},this.onPaste=function(e){delete n.caretMove}}return e.prototype.setInitialValue=function(e){var t=e.target.value;if(!t||!t.length){this._elementRef.nativeElement.value=this.service.getInitialValue(this.mask);var r=this.service.getFirstAvailableCaretPos(this.mask);e.target.setSelectionRange(r,r)}},e.prototype.manageCaret=function(e){var t=e.target.selectionStart;t=-1!=e.target.value.indexOf("_")&&e.target.selectionStart>e.target.value.indexOf("_")?e.target.value.indexOf("_"):this.trackCaret(e),e.target.setSelectionRange(t,t)},e.prototype.trackCaret=function(e,t){void 0===t&&(t=0);var r=this.service.caretPosition(e.target.selectionStart,this.mask,e.target.value);return this.caretMove=r+t,-2==t&&(this.caretMove=e.target.selectionStart-2),e.key&&1==e.key.length&&!this.service.isValidForInput(e.key,this.caretMove,this.mask)&&this.caretMove--,this.caretMove},e.prototype.registerOnChange=function(e){this._onChange=e},e.prototype.registerOnTouched=function(e){this._onTouched=e},e.prototype.setDisabledState=function(e){this.renderer.setElementProperty(this._elementRef.nativeElement,"disabled",e)},e.prototype.ngOnInit=function(){this.mask=this.service.determineMask(this.fsPhoneConfig.maskType,this.fsPhoneConfig.mask),this.regexes=this.service.combineRegexes(this.mask)},e.prototype.onChangeInterceptor=function(e){var t,r=this.service.getFittingArr(e.target.value,this.mask,this.regexes);t=this.service.formatValue(r,this.mask,e.target.selectionStart,e.element,this.regexes),this.writeValue(t,e.target.selectionStart,!1)},e.prototype.writeValue=function(e,t,r){if(void 0===r&&(r=!0),!r||e){this.renderer.setElementProperty(this._elementRef.nativeElement,"value",e);var n=0;this.caretMove?(t=this.caretMove+1,delete this.caretMove):n=this.service.getCaretDelta(t,this.mask),this._elementRef.nativeElement.setSelectionRange(t+n,t+n),this._onChange(e)}},n([c.Input("fsPhoneConfig"),o("design:type",Object)],e.prototype,"fsPhoneConfig",void 0),e=n([c.Directive({host:{"(input)":"onChangeInterceptor($event)","(keyup)":"onKeyup($event)","(keydown)":"onKeydown($event)","(tap)":"onClick($event)","(focus)":"onFocused($event)","(paste)":"onPaste($event)","(blur)":"_onTouched()"},selector:"[fsPhone]",providers:[a.PHONE_VALUE_ACCESSOR]}),i(0,c.Inject(c.ElementRef)),i(1,c.Inject(c.Renderer)),o("design:paramtypes",[c.ElementRef,c.Renderer,s.FsPhone])],e)}();t.FsPhoneDirective=u},"./fsphone.module.ts":function(e,t,r){"use strict";var n=this&&this.__decorate||function(e,t,r,n){var o,i=arguments.length,s=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,r,n);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(s=(i<3?o(s):i>3?o(t,r,s):o(t,r))||s);return i>3&&s&&Object.defineProperty(t,r,s),s};Object.defineProperty(t,"__esModule",{value:!0});var o=r("@angular/core"),i=r("@angular/common");r("hammerjs");var s=r("./fsphone.directive.ts"),a=r("./services/fsphone.service.ts"),c=function(){function e(){}return t=e,e.forRoot=function(){return{ngModule:t,providers:[a.FsPhone]}},e=t=n([o.NgModule({imports:[i.CommonModule],exports:[s.FsPhoneDirective],entryComponents:[],declarations:[s.FsPhoneDirective],providers:[a.FsPhone]})],e);var t}();t.FsPhoneModule=c},"./fsphone.value-accessor.ts":function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r("./fsphone.directive.ts"),o=r("@angular/core"),i=r("@angular/forms");t.PHONE_VALUE_ACCESSOR={provide:i.NG_VALUE_ACCESSOR,useExisting:o.forwardRef(function(){return n.FsPhoneDirective}),multi:!0}},"./index.ts":function(e,t,r){"use strict";function n(e){for(var r in e)t.hasOwnProperty(r)||(t[r]=e[r])}Object.defineProperty(t,"__esModule",{value:!0}),n(r("./fsphone.module.ts")),n(r("./fsphone.directive.ts")),n(r("./services/fsphone.service.ts"))},"./services/fsphone.service.ts":function(e,t,r){"use strict";var n=this&&this.__decorate||function(e,t,r,n){var o,i=arguments.length,s=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,r,n);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(s=(i<3?o(s):i>3?o(t,r,s):o(t,r))||s);return i>3&&s&&Object.defineProperty(t,r,s),s};Object.defineProperty(t,"__esModule",{value:!0});var o=r("@angular/core"),i=r("./fsphone-masks.ts"),s=function(){function e(){}return e.prototype.determineMask=function(e,t){return e&&i.PHONE_MASKS[e]?i.PHONE_MASKS[e]:t||void 0},e.prototype.getCaretDelta=function(e,t){for(var r=1;"string"==typeof t[e+r];)r++;return r},e.prototype.caretPosition=function(e,t,r){for(var n=(r.split(""),e),o=e;o<=n;o++)"string"==typeof t[o]&&n++;return n},e.prototype.getFirstAvailableCaretPos=function(e){for(var t=0;t<=e.length-1;t++)if("string"!=typeof e[t])return t},e.prototype.combineRegexes=function(e){var t=[];return e.forEach(function(e,r){"object"==typeof e&&t.push({regex:e,index:r})}),t},e.prototype.getFittingArr=function(e,t,r){for(var n=e.split(""),o=0,i=[],s=0;s<n.length;s++){var a=r[o];a&&a.regex.test(t[s])||a&&n[s]&&a.regex.test(n[s])&&(o++,i.push({index:a.index,value:n[s]}))}return i},e.prototype.isValidForInput=function(e,t,r){return!("object"!=typeof r[t]||!r[t].test(e))},e.prototype.formatValue=function(e,t,r,n,o){var i=[];if(e&&e.length){for(var s=0;s<=e[e.length-1].index;s++)"string"==typeof t[s]&&(i[s]=t[s]);e.forEach(function(e){i[e.index]=e.value});for(var s=i.length;s<t.length;s++)"string"==typeof t[s]?i[s]=t[s]:i[s]="_";return this.cutIt(i.join(""),t)}return""},e.prototype.fillInValue=function(e,t,r){return"_"==e[r+1]&&e.splice(r+1,1),e},e.prototype.replaceRecursive=function(e,t,r){if("string"==typeof t[r]){if(e[r]==t[r])return this.replaceRecursive(e,t,++r);var n=e[r];return e[r]=t[r],n&&(e[r+1]=n),this.replaceRecursive(e,t,r+1)}return"object"==typeof t[r]?(e[r]||(e[r]="_"),e=this.fillInValue(e,t,r),this.replaceRecursive(e,t,++r)):e},e.prototype.cutIt=function(e,t){return e.slice(0,t.length)},e.prototype.getInitialValue=function(e){void 0===e&&(e=null);var t="";return e.forEach(function(e){t+="string"==typeof e?e:"_"}),t},e=n([o.Injectable()],e)}();t.FsPhone=s},"@angular/common":function(e,t){e.exports=require("@angular/common")},"@angular/core":function(e,t){e.exports=require("@angular/core")},"@angular/forms":function(e,t){e.exports=require("@angular/forms")},hammerjs:function(e,t){e.exports=require("hammerjs")}})});